arch:
  nodes:
  - !Memory
    name: DRAM
    size: inf
    total_latency: (read_actions + write_actions) / (8 * 614e9) # 614 GB/s
    leak_power: 0
    area: 0 # Don't include off-chip DRAM area
    actions:
      # Upper end of the range from the TPU paper. The lower end came from their
      # reference, and they said it left out some things.
    - {name: read, energy: 7.03e-12, latency: 0}
    - {name: write, energy: 7.03e-12, latency: 0}
    tensors: {keep: ~Intermediates, may_keep: All}

  - !Compute
    name: MAC
    total_latency: compute_actions / 1.05e9
    leak_power: 0
    area: 9e-11 # 90 um^2. Very rough estimate based on die photo.
    actions:
    - {name: compute, energy: 0.084e-12, latency: 0}
    spatial:
    - {name: ArrayX, fanout: 512, reuse: output}