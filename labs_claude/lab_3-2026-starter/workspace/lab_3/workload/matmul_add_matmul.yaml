workload:
  rank_sizes:
    M: {{ M }}
    NA: {{ N }}
    NX: {{ N }}
    NY: {{ N }}
    NZ: {{ N }}
    
  bits_per_value:
    All: 8

  einsums:
  - name: EinsumX
    tensor_accesses:
    - {name: A, projection: [m,  na]}
    - {name: B, projection: [na, nx]}
    - {name: X, projection: [m,  nx], output: True}
  - name: EinsumY
    tensor_accesses:
    - {name: X, projection: [m, nx]}
    - {name: C, projection: [m, nx]}
    - {name: Y, projection: {M: m, NY: nx}, output: True}
  - name: EinsumZ
    tensor_accesses:
    - {name: Y, projection: [m,  ny]}
    - {name: D, projection: [ny, nz]}
    - {name: Z, projection: [m,  nz], output: True}