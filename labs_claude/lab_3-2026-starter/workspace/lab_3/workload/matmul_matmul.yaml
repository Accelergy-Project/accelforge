workload:
  rank_sizes:
    M: {{ M }}
    NA: {{ NA }}
    NY: {{ NY }}
    NZ: {{ NZ }}

  bits_per_value:
    All: 8

  einsums:
  - name: EinsumY
    tensor_accesses:
    - {name: A, projection: [m, na]}
    - {name: B, projection: [na, ny]}
    - {name: Y, projection: [m, ny], output: True}
    renames: {weight: B, input: A, output: Y}
  - name: EinsumZ
    tensor_accesses:
    - {name: Y, projection: [m,  ny]}
    - {name: C, projection: [ny, nz]}
    - {name: Z, projection: [m,  nz], output: True}
    renames: {weight: C, input: Y, output: Z}