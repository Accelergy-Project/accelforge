# Unified arch for fig1: ERT values + bandwidth-based latency + memory sizes.
# Combines arch_energy.yaml + arch_latency.yaml into one file.
# ERT values from ARTIFACT_EVALUATION.md section 2.10.
# Memory sizes: BackingStorage=131072, Buffer=512, Reg=1 (in elements).

arch:
  nodes:
  - !Memory
    name: BackingStorage
    size: 131072
    leak_power: 0
    area: 0
    total_latency: "ceil(read_actions + metadata_read_actions)"
    tensors: {keep: ~Intermediates, may_keep: All}
    actions:
    - {name: read, energy: 32.2859, bits_per_action: 64, latency: 0}
    - {name: write, energy: 26.065, bits_per_action: 64, latency: 0}
    - {name: metadata_read, energy: 14.0361, bits_per_action: 64, latency: 0}

  - !Memory
    name: Buffer
    size: 512
    leak_power: 0
    area: 0
    total_latency: "ceil(max((read_actions + metadata_read_actions) / 2, (write_actions + metadata_write_actions) / 2))"
    tensors: {keep: ~BackingStorage, may_keep: All}
    actions:
    - {name: read, energy: 0.42568, bits_per_action: 8, latency: 0}
    - {name: write, energy: 0.58331, bits_per_action: 8, latency: 0}
    - {name: gated_read, energy: 0.00001, bits_per_action: 8, latency: 0}
    - {name: metadata_read, energy: 0.7383, bits_per_action: 8, latency: 0}
    - {name: metadata_write, energy: 1.42366, bits_per_action: 8, latency: 0}
    - {name: gated_metadata_read, energy: 0.00002, bits_per_action: 8, latency: 0}

  - !Memory
    name: Reg
    size: 1
    leak_power: 0
    area: 0
    total_latency: "max(max_tensor_read_actions, max_tensor_write_actions)"
    tensors: {keep: All}
    actions:
    - {name: read, energy: 0.49, bits_per_action: 8, latency: 0}
    - {name: write, energy: 0.49, bits_per_action: 8, latency: 0}

  - !Memory
    name: RegPassthrough
    size: 1
    leak_power: 0
    area: 0
    total_latency: "0"
    tensors: {keep: All}
    actions:
    - {name: read, energy: 0, bits_per_action: 8, latency: 0}
    - {name: write, energy: 0, bits_per_action: 8, latency: 0}

  - !Compute
    name: MAC
    leak_power: 0
    area: 0
    actions:
    - {name: compute, energy: 0.5608, latency: 1}
    - {name: gated_compute, energy: 0.03642, latency: 0}
