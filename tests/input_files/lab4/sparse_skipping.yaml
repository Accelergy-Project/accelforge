# Lab 4 skipping: CSR at BackingStorage+Buffer + skipping SAF at Buffer + MAC
# UOP+CP compression at both levels.
# metadata_storage_width matches the physical SRAM word width at each level
# (BackingStorage=32 bits, Buffer=8 bits) so format elements are packed correctly.

sparse_optimizations:
  targets:
  - target: BackingStorage
    representation_format:
    - name: A
      format: csr
      metadata_word_bits: 4
      metadata_storage_width: 4
    - name: B
      format: csr
      metadata_word_bits: 4
      metadata_storage_width: 4

  - target: Buffer
    representation_format:
    - name: A
      format: csr
      metadata_word_bits: 4
      metadata_storage_width: 8
    - name: B
      format: csr
      metadata_word_bits: 4
      metadata_storage_width: 8
    action_optimization:
    - kind: skipping
      target: A
      condition_on: [B]
    - kind: skipping
      target: B
      condition_on: [A]
    - kind: skipping
      target: Z
      condition_on: [A, B]

  - target: MAC
    compute_optimization:
    - kind: skipping
      target: Z
      condition_on: [A, B]
