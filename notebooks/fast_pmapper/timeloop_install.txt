export NTL_VER=11.5.1
export BARVINOK_VER=0.41.6

wget https://libntl.org/ntl-${NTL_VER}.tar.gz \
&& tar -xvzf ntl-${NTL_VER}.tar.gz \
&& cd ntl-${NTL_VER}/src \
&& ./configure NTL_GMP_LIP=on SHARED=on \
&& make -j128 \
&& make install \
&& cd ../..

wget https://barvinok.sourceforge.io/barvinok-${BARVINOK_VER}.tar.gz \
&& tar -xvzf barvinok-${BARVINOK_VER}.tar.gz \
&& cd barvinok-${BARVINOK_VER} \
&& ./configure --enable-shared-barvinok \
&& make -j128 \
&& make install \
&& cd ..

apt-get update \
    && DEBIAN_FRONTEND=noninteractive TZ=Etc/UTC apt-get -y install tzdata \
    && apt-get install -y --no-install-recommends \
                    locales \
                    curl \
                    git \
                    wget \
                    python3-dev \
                    python3-pip \
                    scons \
                    make \
                    autotools-dev \
                    autoconf \
                    automake \
                    libtool \
    && apt-get install -y --no-install-recommends \
                    g++ \
                    cmake

apt-get update \
    && apt-get install -y --no-install-recommends \
                    g++ \
                    libconfig++-dev \
                    libboost-dev \
                    libboost-filesystem-dev \
                    libboost-iostreams-dev \
                    libboost-log-dev \
                    libboost-serialization-dev \
                    libboost-thread-dev \
                    libyaml-cpp-dev \
                    libncurses5-dev \
                    libtinfo-dev \
                    libgpm-dev \
                    libgmp-dev

git clone https://github.com/gilbertmike/timeloop.git
cd timeloop
cp -r pat-public/src/pat src/pat
scons -j128 --with-isl --static