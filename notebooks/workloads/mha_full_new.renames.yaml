renames:
  version: "0.5"
  einsums:
  - name: default
    tensor_accesses:
    - name: input
      source: Inputs() & Intermediates()
      injective: True
    - name: output
      source: Outputs()
      injective: True
    - name: weight
      source: ~(input | output)
      injective: True

  # - name: Q
  #   tensor_accesses:
  #   - name: weight
  #     source: WQ
  #     injective: True
  # - name: K
  #   tensor_accesses:
  #   - name: weight
  #     source: WK
  #     injective: True
  # - name: V
  #   tensor_accesses:
  #   - name: weight
  #     source: WV
  #     injective: True

  - name: I
    tensor_accesses:
    - name: weight
      source: Nothing
    - name: input
      source: Inputs()
  - name: QK
    tensor_accesses:
    - name: input
      source: Q
      injective: True
  - name: AV
    tensor_accesses:
    - name: input
      source: QK
      injective: True
