arch:
  nodes:
  - !Memory
    name: MainMemory

  - !Network
    name: NoC
    spatial:
    - {name: X, fanout: 4}
    - {name: Y, fanout: 4}
    nodes:
    - !Memory
      name: GlobalBuffer
      tensors: {keep: ~MainMemory, may_keep: All}
      actions:
      - {name: read, energy: 1, latency: {{GlobalBufferLatency}}}
      - {name: write, energy: 1, latency: {{GlobalBufferLatency}}}

    - !Memory
      name: RowBuffer
      tensors: {keep: ~MainMemory, may_keep: All}
      actions:
      - {name: read, energy: 1, latency: {{GlobalBufferLatency}}}
      - {name: write, energy: 1, latency: {{GlobalBufferLatency}}}
      spatial:
      - {name: X, fanout: 4}

    - !Memory
      name: ColumnBuffer
      tensors: {keep: ~MainMemory, may_keep: All}
      actions:
      - {name: read, energy: 1, latency: {{GlobalBufferLatency}}}
      - {name: write, energy: 1, latency: {{GlobalBufferLatency}}}
      spatial:
      - {name: Y, fanout: 4}

    - !Memory
      name: DistributedBuffer
      tensors: {keep: ~MainMemory, may_keep: All}
      spatial:
      - {name: X, fanout: 2}
      - {name: Y, fanout: 2}

    - !Hierarchy
      spatial:
      - {name: X, fanout: 4}
      - {name: Y, fanout: 4}
      nodes:
      - !Memory
        name: Scratchpad

      - !Compute
        name: MAC